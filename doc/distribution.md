# Preparing a Distribution

Whether you are creating a release for end users or building packages for a
custom environment, the following guidelines apply.

## Versioning

The version string is controlled by the `CWIPC_VERSION` CMake variable.  Set
it in `CMakeUserPresets.json` or when configuring the build:

```sh
cmake -DCWIPC_VERSION=1.2.3 ..
```

The `CHANGELOG.md` file should be updated with all user‑visible changes prior
to tagging a release.

## Binary packages

* **macOS:** Build a Homebrew formula (`homebrew-cwipc` repository) that refers
to the tarball generated by `cpack` (the CMake packaging tool).  The formula
runs `brew install` which unpacks the tarball into the Cellar.
* **Windows:** Use the installer scripts under `scripts/` to construct a
  self‑extracting `.exe` with NSIS.  The `CMakeLists.txt` contains the
  necessary `CPack` configuration.
* **Ubuntu/Debian:** Use `cpack` with the `DEB` generator or create a custom
  `deb` using `dpkg-deb` similar to the existing release workflow.

The command `cmake --build build --target package` (after a successfully
configured build) will create tar, deb, or other packages depending on the
`CPack` generators that are enabled.

## Source releases

`cpack` can also create a source tarball:

```sh
cmake --build build --target package_source
```

This tarball contains the full Git tree with submodules and can be used by
downstream packagers.

## Python modules

The `cwipc_pymodules_install.sh` (and Windows `.bat`) script installs the
python extensions into the active environment.  For distribution we release
wheel files and upload them to PyPI under the `cwipc` package name.

## Continuous integration

The project uses GitHub Actions (`.github/workflows/build.yml`) to build and
package on every push.  Tags matching `v*` trigger a release job which uploads
artifacts to GitHub Releases and updates the Homebrew formula.

## Building and publishing the documentation

Documentation is generated from the `doc/` markdown files using Sphinx with
the ReadTheDocs theme.  The repository includes a minimal Sphinx project
under `docs/` and a `requirements.txt` listing the necessary packages
(`sphinx`, `myst-parser`, `sphinx-rtd-theme`).

To build locally:

```sh
cd docs
python -m pip install -r requirements.txt
sphinx-build -b html . _build/html
```

The HTML output appears in `docs/_build/html`.  Run the same commands in a CI
job to verify formatting or catch broken links.

On ReadTheDocs the project is configured to use this `docs/` folder as the
source.  Pushing updates to `main` automatically triggers a rebuild on RTD
and publishes the documentation at `https://cwipc.readthedocs.io` (or similar).
For private/internal hosting the same build steps can be run on a server and
the resulting static files deployed to a web host or CDN.

[Back to Contents](index.md)
